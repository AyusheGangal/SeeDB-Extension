drop table survey;

create table survey(
        Age integer,
        Gender varchar(200),
        Country varchar(200),
        self_employed varchar(200),
        family_history varchar(200),
        treatment varchar(200),
        work_interfere varchar(200),
        company_size varchar(200),
        remote_work varchar(200),
        tech_company varchar(200),
        benefits varchar(200),
        care_options varchar(200),
        wellness_program varchar(200),
        seek_help varchar(200),
        anonymity varchar(200),
        leave varchar(200),
        mental_health_consequence varchar(200),
        phys_health_consequence varchar(200),
        coworkers varchar(200),
        supervisor varchar(200),
        mental_health_interview varchar(200),
        phys_health_interview varchar(200),
        mental_vs_physical varchar(200),
        obs_consequence varchar(200)
        );
        
COPY survey FROM '/Users/ayushe/Downloads/survey_mht_clean.csv' DELIMITER ',' CSV HEADER;

select * from survey;
 
#1 target + reference = self-employed Y / N
create table self_employed_people as select * from survey where self_employed ='Yes';
alter table self_employed_people drop self_employed;
create table not_self_employed_people as select * from survey where self_employed ='No';
alter table not_self_employed_people drop self_employed;

select * from self_employed_people;
select * from not_self_employed_people;




#2 target + reference = family_history Y / N
create table family_history_people as select * from survey where family_history ='Yes';
alter table family_history_people drop family_history;
create table no_family_history_people as select * from survey where family_history ='No';
alter table no_family_history_people drop family_history;

select * from family_history_people;
select * from no_family_history_people;



#3 target + reference = treatment Y / N
create table treatment_people as select * from survey where treatment ='Yes';
alter table treatment_people drop treatment;
create table no_treatment_people as select * from survey where treatment ='No';
alter table no_treatment_people drop treatment;

select * from treatment_people;
select * from no_treatment_people;



#4 target + reference = remote_work Y / N
create table remote_work_people as select * from survey where remote_work ='Yes';
alter table remote_work_people drop remote_work;
create table no_remote_work_people as select * from survey where remote_work ='No';
alter table no_remote_work_people drop remote_work;

select * from remote_work_people;
select * from no_remote_work_people;



COPY self_employed_people TO '/Users/ayushe/Downloads/self_employed_people.csv' DELIMITER ',' CSV HEADER;
COPY not_self_employed_people TO '/Users/ayushe/Downloads/not_self_employed_people.csv' DELIMITER ',' CSV HEADER;

COPY treatment_people TO '/Users/ayushe/Downloads/treatment_people.csv' DELIMITER ',' CSV HEADER;
COPY no_treatment_people TO '/Users/ayushe/Downloads/no_treatment_people.csv' DELIMITER ',' CSV HEADER;

COPY family_history_people TO '/Users/ayushe/Downloads/family_history_people.csv' DELIMITER ',' CSV HEADER;
COPY no_family_history_people TO '/Users/ayushe/Downloads/no_family_history_people.csv' DELIMITER ',' CSV HEADER;

COPY remote_work_people TO '/Users/ayushe/Downloads/remote_work_people.csv' DELIMITER ',' CSV HEADER;
COPY no_remote_work_people TO '/Users/ayushe/Downloads/no_remote_work_people.csv' DELIMITER ',' CSV HEADER;
